<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<title>Submit Post | SEO India Online Free Blog</title>

<meta name="description" content="Submit your digital marketing article on SEO India Online Free Blog. Free blog posting platform.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Analytics GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GT-NFP4RC7H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-TS799JPTG6', { anonymize_ip: true });
</script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f6f8;
}
nav{
  background:#062f4f;
  padding:12px;
  text-align:center;
}
nav a{
  color:#fff;
  margin:0 12px;
  font-weight:bold;
  text-decoration:none;
}
.header{
  background:#0a3d62;
  color:#fff;
  text-align:center;
  padding:25px;
}
.container{
  max-width:900px;
  margin:30px auto;
  background:#fff;
  padding:30px;
}
input, textarea, button{
  width:100%;
  padding:12px;
  margin-bottom:15px;
  font-size:16px;
}
textarea{
  min-height:260px;
}
button{
  background:#0a3d62;
  color:#fff;
  border:none;
  cursor:pointer;
}
button:hover{
  background:#062f4f;
}
.note{
  font-size:14px;
  color:#555;
}
.error{
  color:red;
  margin-bottom:15px;
}
footer{
  background:#0a3d62;
  color:#fff;
  text-align:center;
  padding:15px;
}
</style>
</head>

<body>

<!-- NAVIGATION -->
<nav>
  <a href="index.html">Home</a>
  <a href="posts.html">Posts</a>
  <a href="submit-post.html">Submit</a>
  <a href="login.html">Login</a>
  <a href="register.html">Register</a>
</nav>

<!-- HEADER -->
<div class="header">
  <h1>SEO India Online Free Blog</h1>
  <p>Submit Your Digital Marketing Article</p>
</div>

<!-- FORM -->
<div class="container">

  <h2>Submit New Post</h2>

  <div class="note">
    ✔ Minimum 200 words<br>
    ✔ Original content only<br>
    ✔ HTML, Markdown & BBCode supported<br>
    ✔ SEO-friendly links allowed
  </div>

  <div id="errorMsg" class="error"></div>

  <form id="postForm">
    <input type="text" id="title" placeholder="Post Title" required>

    <textarea id="content" placeholder="Write your article here (HTML / Markdown / BBCode supported)" required></textarea>

    <button type="submit">Publish Post</button>
  </form>

</div>

<footer>
  © 2026 SEO India Online Free Blog
</footer>

<!-- FIREBASE POST SUBMISSION -->
<script type="module">
import { auth, db } from "./firebase.js";
import {
  addDoc,
  collection,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
import { onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

const form = document.getElementById("postForm");
const errorMsg = document.getElementById("errorMsg");

let currentUser = null;

// Auth check
onAuthStateChanged(auth, user => {
  if (!user) {
    location.href = "login.html";
  } else {
    currentUser = user;
  }
});

form.addEventListener("submit", async e => {
  e.preventDefault();
  errorMsg.textContent = "";

  const title = document.getElementById("title").value.trim();
  const content = document.getElementById("content").value.trim();

  if (!title || !content) {
    errorMsg.textContent = "All fields are required.";
    return;
  }

  const wordCount = content.split(/\s+/).length;
  if (wordCount < 200) {
    errorMsg.textContent = "Post must be at least 200 words.";
    return;
  }

  try {
    await addDoc(collection(db, "posts"), {
      title: title,
      content: content,
      authorName: currentUser.displayName || "Guest",
      createdAt: serverTimestamp(),
      status: "published"
    });

    // GA4 event
    gtag('event', 'post_submitted', {
      event_category: 'content',
      event_label: title
    });

    alert("Post published successfully!");
    location.href = "posts.html";

  } catch (err) {
    errorMsg.textContent = err.message;
  }
});
</script>

</body>
</html>
